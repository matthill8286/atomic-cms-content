{"version":3,"sources":["../../../src/components/ProductNewsCarousel/ProductNewsCarousel.tsx"],"names":["React","useEffect","useState","useInView","ScrollSnapSlider","useWindowDimensions","ProductSponsoring","CarouselWrapper","TileFragment","TileWrapper","ProductNewsCarousel","loading","promoted","promotedIndex","products","context","tileMargin","withOverflow","withGrid","showArrows","showBookmark","showSkills","showProvider","sponsoringDetails","showLock","videoFallbackImage","fixedArrowPosition","zeroArrowPosition","renderAddToBookmarkButton","title","tileWidth","hideDummies","dataTest","withLQIP","withNativeLoading","withScrollbar","onProductClick","onSlideChange","onInView","arrowPrevClass","arrowNextClass","scrolled","scrolledSet","breakpoint","prevSlideIndex","setPrevSlideIndex","productsPerSlideWithHook","threshold","triggerOnce","rootMargin","ref","inView","undefined","length","handleSlideChange","productsPerSlide","nextSlideIndex","direction","slideIndex","productsInSlide","slice","assetAmount","pageNumber","handleProductClick","event","asset","index","preventDefault","locked","tileSettings","fontSize","withEllipsis","renderProduct","Math","floor","isDummyTile","description","assetTileProduct","Wrapper","isSponsored","productsWithSponsor","sponsored","renderProducts","map","promotedElement"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useInView } from 'react-intersection-observer'\nimport {\n  ScrollSnapSlider,\n  useWindowDimensions,\n  ProductSponsoring,\n  ProductTileProps,\n  Product,\n} from '@matthill8286/atomic-ui'\nimport { ProductNewsCarouselProps } from './ProductNewsCarousel.interface'\nimport { CarouselWrapper, TileFragment, TileWrapper } from './ProductNewsCarousel.styled'\n\nexport const ProductNewsCarousel: React.FC<ProductNewsCarouselProps> = ({\n  loading = true,\n  promoted,\n  promotedIndex = 0,\n  products = [],\n  context = 'home-scroll-carousel',\n  tileMargin = 'md',\n  withOverflow = true,\n  withGrid = false,\n  showArrows = true,\n  showBookmark = true,\n  showSkills = true,\n  showProvider,\n  sponsoringDetails,\n  showLock = false,\n  videoFallbackImage,\n  fixedArrowPosition = true,\n  zeroArrowPosition = false,\n  renderAddToBookmarkButton,\n  title,\n  tileWidth = 250,\n  hideDummies = false,\n  dataTest,\n  withLQIP,\n  withNativeLoading,\n  withScrollbar = true,\n  onProductClick = () => {\n    return null\n  },\n  onSlideChange = () => {\n    return null\n  },\n  onInView,\n  arrowPrevClass,\n  arrowNextClass,\n}): JSX.Element | null => {\n  const [scrolled, scrolledSet] = useState<boolean>(false)\n  const { breakpoint } = useWindowDimensions()\n  const [prevSlideIndex, setPrevSlideIndex] = useState(0)\n\n  const productsPerSlideWithHook: any = true\n\n  const [ref, inView] = useInView({\n    threshold: 0,\n    triggerOnce: true,\n    rootMargin: '50px 0px',\n  })\n\n  useEffect(() => {\n    if (inView && onInView !== undefined && !loading && products.length > 0) {\n      onInView({ context })\n    }\n  }, [inView, loading, onInView, context, products])\n\n  if (!products) {\n    return null\n  }\n\n  const handleSlideChange = (productsPerSlide: number) => (nextSlideIndex: number) => {\n    scrolledSet(false)\n    const direction = nextSlideIndex > prevSlideIndex ? 'Next' : 'Previous'\n    const slideIndex = nextSlideIndex / productsPerSlide\n    setPrevSlideIndex(nextSlideIndex)\n    const productsInSlide = products.slice(\n      slideIndex * productsPerSlide,\n      slideIndex * productsPerSlide + productsPerSlide\n    )\n    onSlideChange?.({\n      products: productsInSlide,\n      direction,\n      assetAmount: productsPerSlide,\n      pageNumber: slideIndex,\n      context,\n    })\n  }\n\n  const handleProductClick = (productsPerSlide: number) => (\n    event: React.MouseEvent<HTMLElement, MouseEvent>,\n    asset: Product | Partial<Product>,\n    index: number,\n    pageNumber: number\n  ) => {\n    if (scrolled) {\n      event.preventDefault()\n    }\n\n    if (!asset.locked && onProductClick) {\n      onProductClick({ asset, index, productsPerSlide, pageNumber, context })\n    }\n  }\n\n  const tileSettings: Omit<ProductTileProps, 'product'> = {\n    loading,\n    fontSize: 'sm',\n    sponsoringDetails: undefined,\n    withEllipsis: true,\n  }\n\n  const renderProduct = (productsPerSlide: number) => (\n    asset: Product | Partial<Product>,\n    index: number\n  ): JSX.Element => {\n    const slideIndex = Math.floor(index / productsPerSlide)\n    const isDummyTile = !withOverflow && !asset.description\n\n    const assetTileProduct: Product | Partial<Product> = {\n      ...asset,\n    }\n\n    // no wrapper in case of sponsored asset\n    const Wrapper = sponsoringDetails?.isSponsored ? TileFragment : TileWrapper\n    const productsWithSponsor = assetTileProduct?.sponsored\n    const loading = tileSettings.loading || isDummyTile\n\n    return (\n      <Wrapper\n        hideDummy={isDummyTile && hideDummies && !scrolled}\n        aria-rowindex={index}\n        key={`ProductTile-${index}`}\n        withLabels={productsWithSponsor}>\n        <p>Testing</p>\n      </Wrapper>\n    )\n  }\n\n  const renderProducts = () => {\n    if (!promoted)\n      return [...products.map(renderProduct(productsPerSlideWithHook)), <div key=\"right-spacer\" />]\n    const promotedElement: (boolean | JSX.Element | null)[] = promoted ? [promoted] : []\n    return [\n      ...products.slice(0, promotedIndex).map(renderProduct(productsPerSlideWithHook)),\n      ...promotedElement,\n      ...products.slice(promotedIndex).map(renderProduct(productsPerSlideWithHook)),\n      <div key=\"right-spacer\" />,\n    ]\n  }\n\n  return (\n    <CarouselWrapper\n      tileMargin={tileMargin}\n      tileWidth={tileWidth}\n      ref={ref}\n      key={`Carousel-${products.length}`}\n      {...(typeof dataTest !== 'undefined' && { 'data-test': dataTest })}>\n      {sponsoringDetails ? (\n        <ProductSponsoring layout=\"carousel\" sponsoringDetails={sponsoringDetails} />\n      ) : null}\n      <ScrollSnapSlider\n        slideWidth={tileWidth}\n        isGridLayout\n        withGrid={withGrid}\n        showScrollbar={withScrollbar && products.length > 3}\n        onScrollStart={() => {\n          if (!scrolled) scrolledSet(true)\n        }}\n        onScrollEnd={handleSlideChange(productsPerSlideWithHook)}\n        showArrows={showArrows && products.length > 3}\n        arrowDataTest=\"scroll-snap-slider-arrow\"\n        arrowPrevClass={arrowPrevClass}\n        arrowNextClass={arrowNextClass}\n        fixedArrowPosition={fixedArrowPosition}\n        zeroArrowPosition={zeroArrowPosition}\n        title={title}>\n        {renderProducts()}\n      </ScrollSnapSlider>\n    </CarouselWrapper>\n  )\n}\n"],"file":"ProductNewsCarousel.js"}